# 简历批量下载工具使用说明

## 功能说明

这个脚本可以自动登录指定网页，批量下载"投递简历"列的所有附件，并根据"名气直推投递"列的学员内容来重命名简历文件。

## 安装依赖

```bash
pip install playwright
playwright install chromium
```

## 使用方法

### 基本使用

```bash
python resume_downloader.py
```

### 运行流程

1. **启动浏览器**：脚本会自动启动 Chrome 浏览器（非无头模式，方便观察和调试）

2. **登录网页**：
   - 脚本会尝试自动填写登录表单
   - 如果自动登录失败，会提示你手动登录
   - 登录完成后按回车继续

3. **下载简历**：
   - 脚本会自动查找表格中的"投递简历"列
   - 下载所有附件
   - 根据"名气直推投递"列的学员名称重命名文件

4. **文件保存**：
   - 所有下载的简历会保存在 `resumes` 文件夹中
   - 文件名格式：`{学员名称}.{文件扩展名}`
   - 如果文件名重复，会自动添加序号

## 配置选项

可以在脚本中修改以下参数：

```python
downloader = ResumeDownloader(
    download_dir=None,  # 下载目录，默认为 resumes 文件夹
    headless=False      # 是否使用无头模式（False 可以看到浏览器操作）
)
```

## 注意事项

1. **网页结构变化**：如果网页结构发生变化，可能需要调整选择器。脚本会自动保存页面HTML到 `resumes/page_debug_*.html` 用于调试。

2. **登录方式**：如果自动登录失败，可以手动登录后按回车继续。

3. **网络延迟**：脚本在每次下载之间会等待1秒，避免请求过快。

4. **文件名清理**：脚本会自动清理文件名中的非法字符，确保文件可以正常保存。

5. **重复文件**：如果同一学员有多个简历，会自动添加序号区分。

## 故障排除

### 问题1：找不到表格

**解决方案**：
- 检查页面是否完全加载
- 查看保存的 `page_debug_*.html` 文件，了解页面结构
- 可能需要手动调整选择器

### 问题2：下载失败

**可能原因**：
- 网络连接问题
- 文件链接已失效
- 需要登录状态才能下载

**解决方案**：
- 检查网络连接
- 确保已正确登录
- 查看错误信息，可能需要调整下载逻辑

### 问题3：文件名不正确

**解决方案**：
- 检查"名气直推投递"列的数据是否正确
- 如果该列为空，会使用默认名称 `学员_{序号}`

## 高级用法

如果需要批量处理多个页面或添加更多功能，可以修改脚本：

```python
# 自定义下载目录
downloader = ResumeDownloader(download_dir="/path/to/download")

# 使用无头模式（后台运行）
downloader = ResumeDownloader(headless=True)

# 在代码中直接提供登录信息（不推荐，安全性较低）
downloader.login(username="your_username", password="your_password")
```

## 技术支持

如果遇到问题，请：
1. 查看控制台输出的错误信息
2. 检查保存的调试HTML文件
3. 确认网页结构是否发生变化

