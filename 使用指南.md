# 🎯 每日内推信息自动抓取系统 - 完整使用指南

## 📦 已为您准备的文件

在您的桌面上，我已经创建了以下文件：

### 1. 核心文件
- **daily_referral_scraper_v2.py** - 主程序（增强版）
- **run.sh** - 快速启动脚本
- **requirements.txt** - Python依赖包列表
- **README.md** - 详细说明文档

### 2. 示例输出
- **今日内推汇总_2025-11-25.md** - Markdown格式日报示例
- **今日内推汇总_2025-11-25.xlsx** - Excel格式汇总表示例

---

## 🚀 快速开始（3步搞定）

### 步骤1: 安装依赖（仅首次需要）

打开终端（Terminal），执行：

```bash
cd ~/Desktop
pip3 install -r requirements.txt
```

### 步骤2: 赋予执行权限（仅首次需要）

```bash
chmod +x run.sh
chmod +x daily_referral_scraper_v2.py
```

### 步骤3: 运行程序

```bash
./run.sh
```

或者直接运行Python脚本：

```bash
python3 daily_referral_scraper_v2.py
```

---

## 📊 程序功能说明

### 自动化流程

1. **启动浏览器** - 使用您的Chrome浏览器（保持登录状态）
2. **访问目标网站** - 牛客网、知乎等平台
3. **智能搜索** - 使用多个关键词组合搜索
4. **数据提取** - 自动提取公司名称、内推码、链接等
5. **数据清洗** - 去重、筛选、排序
6. **生成报告** - 创建Markdown日报和Excel表格
7. **识别机会** - 自动提取Top 3捡漏机会

### 输出文件

#### Markdown日报（今日内推汇总_日期.md）
- 📊 完整的内推信息表格
- 🔥 Top 3捡漏机会详解
- 📝 使用建议和注意事项
- 🔗 相关资源链接

#### Excel汇总表（每日内推.xlsx）
- 📈 历史数据累积
- 🎨 自动格式化
- 🔍 支持筛选和排序
- 📅 包含抓取时间戳

---

## ⚙️ 高级配置

### 修改搜索关键词

编辑 `daily_referral_scraper_v2.py`，找到：

```python
scraper.scrape_nowcoder(keywords=['内推码', '2026校招', '内推', '急招'])
```

可以添加更多关键词，例如：

```python
scraper.scrape_nowcoder(keywords=['内推码', '2026校招', '内推', '急招', '补录', '直推'])
```

### 调整抓取数量

找到代码中的：

```python
for post in posts[:15]:  # 取前15条
```

修改数字即可调整每次搜索的抓取数量。

### 添加更多公司

找到 `key_companies` 列表：

```python
self.key_companies = [
    '字节跳动', '腾讯', '阿里巴巴', ...
]
```

添加您关注的公司名称。

---

## 🤖 设置定时自动运行

### 方法1: 使用cron（推荐）

```bash
# 编辑crontab
crontab -e

# 添加以下行（每天早上9点运行）
0 9 * * * cd ~/Desktop && /usr/local/bin/python3 daily_referral_scraper_v2.py >> ~/Desktop/scraper.log 2>&1

# 保存并退出（按ESC，输入:wq，回车）
```

### 方法2: 使用macOS自动操作

1. 打开「自动操作」(Automator)
2. 创建新的「日历提醒」
3. 添加「运行Shell脚本」操作
4. 输入：
   ```bash
   cd ~/Desktop
   ./run.sh
   ```
5. 保存并在日历中设置每日运行时间

### 方法3: 使用LaunchAgent（最稳定）

创建文件 `~/Library/LaunchAgents/com.referral.scraper.plist`：

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>Label</key>
    <string>com.referral.scraper</string>
    <key>ProgramArguments</key>
    <array>
        <string>/usr/local/bin/python3</string>
        <string>/Users/你的用户名/Desktop/daily_referral_scraper_v2.py</string>
    </array>
    <key>StartCalendarInterval</key>
    <dict>
        <key>Hour</key>
        <integer>9</integer>
        <key>Minute</key>
        <integer>0</integer>
    </dict>
    <key>StandardOutPath</key>
    <string>/Users/你的用户名/Desktop/scraper.log</string>
    <key>StandardErrorPath</key>
    <string>/Users/你的用户名/Desktop/scraper_error.log</string>
</dict>
</plist>
```

然后加载：

```bash
launchctl load ~/Library/LaunchAgents/com.referral.scraper.plist
```

---

## 🐛 常见问题解决

### 问题1: ChromeDriver版本不匹配

**错误**: "This version of ChromeDriver only supports Chrome version XX"

**解决**:
```bash
# 卸载旧版本
brew uninstall chromedriver

# 安装最新版本
brew install chromedriver

# 或者手动下载对应版本
# https://chromedriver.chromium.org/downloads
```

### 问题2: 权限被拒绝

**错误**: "Permission denied"

**解决**:
```bash
chmod +x ~/Desktop/run.sh
chmod +x ~/Desktop/daily_referral_scraper_v2.py
```

### 问题3: 找不到模块

**错误**: "ModuleNotFoundError: No module named 'selenium'"

**解决**:
```bash
pip3 install -r requirements.txt

# 或者单独安装
pip3 install selenium pandas openpyxl
```

### 问题4: 浏览器无法启动

**可能原因**:
- Chrome浏览器未安装
- ChromeDriver未安装或版本不匹配
- 路径配置错误

**解决**:
1. 确保Chrome浏览器已安装
2. 安装ChromeDriver: `brew install chromedriver`
3. 检查ChromeDriver是否在PATH中: `which chromedriver`

### 问题5: 抓取不到数据

**可能原因**:
- 网站结构变化
- 需要登录
- 网络连接问题
- 被反爬虫机制拦截

**解决**:
1. 手动登录牛客网等网站
2. 检查网络连接
3. 降低抓取频率（增加sleep时间）
4. 使用代理IP（高级用法）

### 问题6: Excel文件被占用

**错误**: "Permission denied" 或 "File is in use"

**解决**:
关闭所有打开的Excel文件，然后重新运行程序。

---

## 📈 使用技巧

### 1. 提高抓取效率

- **多关键词组合**: 使用更多相关关键词
- **定时运行**: 设置在流量较低的时段运行
- **分批抓取**: 避免一次性抓取过多导致被限制

### 2. 数据质量优化

- **定期清理**: 删除过期的内推信息
- **手动验证**: 对重点公司的内推码进行人工确认
- **更新频率**: 建议每日运行1-2次

### 3. 结果利用

- **Excel筛选**: 使用Excel的筛选功能快速找到目标公司
- **Markdown分享**: 可以直接将Markdown报告分享给同学
- **数据分析**: 统计哪些公司招聘最活跃

---

## 📊 今日手动整理的内推信息（2025-11-25）

基于最新搜索结果，以下是当前最热门的内推机会：

### 🔥 大厂内推码（持续有效）

| 公司 | 内推码 | 特点 |
|------|--------|------|
| 字节跳动 | 514NN66 / DJU7EQP | 5000+ Offer |
| 腾讯 | GDWURSDH / TH5E9DIQ | 免筛选 |
| 京东 | C3XK2 / C4G1Y | 10000+岗位 |
| 网易互娱 | qTHJgo | 1000+ offer |
| 小米 | HQQE9PE / 4Q6GKUB | 校招+社招 |
| 基恩士 | EVVJRB | 年薪18-22W起 |
| 海康威视 | WN98FD / 14WLTK | 应届生友好 |

### 💎 高薪机会（重点推荐）

1. **歌尔股份** - 内推码: oyhygp
   - 硕士40万起，博士55万起
   - 购房补贴25-50万
   - 5年成长为中高层

2. **科大讯飞** - 内推码: 099BA37
   - 飞凡计划
   - 未来领导者培养
   - 24/25/26届均可

3. **美团** - 内推码: GQBLAVN
   - 内推免简历筛选
   - 直接进笔试

---

## 🔗 相关资源

### 求职平台
- [牛客网](https://www.nowcoder.com) - 面经+内推
- [力扣中国](https://leetcode.cn) - 算法题+内推
- [知乎](https://www.zhihu.com) - 经验分享

### GitHub仓库
搜索: `campus-recruitment 2026` 或 `校招内推 2026`

### 微信公众号
- 字节跳动招聘
- 腾讯招聘
- 阿里巴巴招聘

---

## 📝 更新日志

### v2.0 (2025-11-25)
- ✨ 新增自动生成Markdown日报功能
- ✨ 新增Top 3捡漏机会识别
- ✨ 优化数据提取算法
- ✨ 改进Excel格式化
- 🐛 修复重复数据问题
- 🐛 优化错误处理机制

### v1.0 (2025-11-25)
- 🎉 初始版本发布
- ✨ 支持牛客网数据抓取
- ✨ 基础Excel导出功能

---

## 💡 未来计划

- [ ] 支持知乎平台抓取
- [ ] 支持小红书平台抓取
- [ ] 添加微信公众号文章抓取
- [ ] 集成GitHub仓库监控
- [ ] 添加邮件通知功能
- [ ] 开发Web界面
- [ ] 支持多用户协作

---

## 📧 反馈与支持

如有问题或建议，欢迎反馈！

**使用愉快，祝求职顺利！** 🎉

---

**最后更新**: 2025-11-25  
**版本**: v2.0  
**作者**: AI助手小跃
